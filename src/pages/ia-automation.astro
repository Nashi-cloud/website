---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import ContactModal from '../components/ContactModal.astro';

const intelligenceOffers = [
  {
    name: "Starter",
    target: "Indépendants / TPE",
    price: "99",
    maxUsers: 5,
    users: "1 à 5 utilisateurs",
    features: [
      "Modèle Standard (ex: Mistral 7B)",
      "RAG : 50 documents max",
      "Quota : 2M Tokens / mois",
      "VPS Mutualisé (Isolé)",
      "Interface Chat Sécurisée",
      "Hébergement 100% France"
    ],
    highlight: false
  },
  {
    name: "Pro",
    target: "PME / Services Juridiques",
    price: "249",
    maxUsers: 15,
    users: "5 à 15 utilisateurs",
    features: [
      "Modèle Avancé (ex: Mixtral 8x7B)",
      "RAG : 500 documents max",
      "Quota : 10M Tokens / mois",
      "VPS Dédié (4 vCores / 8GB)",
      "Interface Chat Sécurisée",
      "Support Prioritaire"
    ],
    highlight: true
  },
  {
    name: "Enterprise",
    target: "ETI / Grands Groupes",
    price: "499",
    maxUsers: 50,
    users: "15 à 50 utilisateurs",
    features: [
      "Multi-modèles au choix",
      "RAG Illimité (Drive/Sharepoint)",
      "Quota : 40M Tokens / mois",
      "VPS Dédié Haute Perf (16GB+)",
      "SSO & Logs d'audit",
      "Support Dédié"
    ],
    highlight: false
  }
];

const n8nOffers = [
  {
    name: "Starter",
    target: "1 Admin",
    price: "49",
    features: [
      "Instance n8n Pré-configurée",
      "10 Workflows actifs",
      "Quota IA : 500k Tokens / mois",
      "Maintien en condition ops",
      "Sauvegardes J-1"
    ]
  },
  {
    name: "Pro",
    target: "Jusqu'à 5 Admins",
    price: "129",
    features: [
      "n8n + Environnement Python",
      "Workflows Illimités",
      "Quota IA : 2M Tokens / mois",
      "Support Ticket J+1",
      "Sauvegardes J-7"
    ],
    highlight: true
  },
  {
    name: "Enterprise",
    target: "Équipe illimitée",
    price: "299",
    features: [
      "n8n Haute Dispo (Workers)",
      "Workflows Illimités & Prioritaires",
      "Quota IA : 10M Tokens / mois",
      "Support dédié + Audit",
      "SLA Garanti"
    ]
  }
];

const pythonOffers = [
  {
    name: "Runner Start",
    target: "Tâches simples",
    price: "79",
    desc: "Tri emails, posts réseaux...",
    features: [
      "Exécution 1x / jour",
      "Script Python managé",
      "Mise à jour API incluse",
      "Quota IA : 1M Tokens / mois"
    ]
  },
  {
    name: "Runner Pro",
    target: "Tâches lourdes",
    price: "199",
    desc: "Scrapers, CRM sync, RAG...",
    features: [
      "Exécution chaque heure",
      "Python + Base de données dédiée",
      "Mise à jour API incluse",
      "Quota IA : 5M Tokens / mois"
    ],
    highlight: true
  },
  {
    name: "Runner Elite",
    target: "Critique / Temps réel",
    price: "Sur Devis",
    desc: "Gros volumes, Webhooks...",
    features: [
      "Temps réel / Webhooks",
      "Cluster Python + Redis",
      "Monitoring 24/7 inclus",
      "Quota IA sur mesure"
    ]
  }
];
---

<Layout title="IA & Automatisation Souveraine | Nashi Cloud">
  <Header />
  
  <main class="pt-20" x-data="{ automationTab: 'n8n' }">
    <!-- Hero Section -->
    <section class="relative py-20 bg-nashi-900 overflow-hidden">
      <div class="absolute inset-0 overflow-hidden">
        <div class="absolute -top-[50%] -right-[20%] w-[80%] h-[80%] rounded-full bg-nashi-600/20 blur-3xl"></div>
        <div class="absolute bottom-[10%] -left-[10%] w-[40%] h-[40%] rounded-full bg-blue-600/10 blur-3xl"></div>
      </div>
      
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10 text-center">
        <span class="inline-block py-1 px-3 rounded-full bg-nashi-800 border border-nashi-700 text-nashi-300 text-sm font-semibold mb-6">
          Nouvelle Ère
        </span>
        <h1 class="text-4xl md:text-6xl font-extrabold text-white mb-6 tracking-tight">
          L'Intelligence Artificielle,<br/>
          <span class="text-transparent bg-clip-text bg-gradient-to-r from-nashi-300 to-white">Sans compromis sur vos données.</span>
        </h1>
        <p class="text-xl text-nashi-200 max-w-3xl mx-auto mb-10">
          Déployez des assistants IA (Chat/RAG) et automatisez vos processus métiers sur une infrastructure souveraine, hébergée en France.
        </p>
        <div class="flex justify-center gap-4">
            <a href="#intelligence" class="px-6 py-3 rounded-full bg-white text-nashi-900 font-bold hover:bg-nashi-100 transition-colors">
                Offres IA
            </a>
            <a href="#automate" class="px-6 py-3 rounded-full bg-nashi-800 text-white font-bold hover:bg-nashi-700 transition-colors border border-nashi-700">
                Offres Automatisation
            </a>
        </div>
      </div>
    </section>

    <!-- SECTION 1: NASHI INTELLIGENCE -->
    <section id="intelligence" class="py-24 bg-white" x-data="{ perUser: false }">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-12">
          <h2 class="text-3xl md:text-4xl font-bold text-nashi-900 mb-4">Nashi Intelligence</h2>
          <p class="text-lg text-nashi-600 max-w-2xl mx-auto mb-8">
            Votre assistant d'entreprise sécurisé (type ChatGPT), connecté à vos documents, hébergé chez vous.
          </p>

          <!-- Toggle Switch -->
          <div class="flex items-center justify-center gap-4">
            <span class="text-sm font-medium" :class="!perUser ? 'text-nashi-900 font-bold' : 'text-nashi-900/60'">Prix Total</span>
            <button 
                class="relative inline-flex h-8 w-14 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-nashi-500 focus:ring-offset-2"
                :class="perUser ? 'bg-nashi-600' : 'bg-nashi-300'"
                @click="perUser = !perUser"
            >
                <span class="sr-only">Changer l'affichage du prix</span>
                <span 
                    class="inline-block h-6 w-6 transform rounded-full bg-white transition-transform shadow-sm"
                    :class="perUser ? 'translate-x-7' : 'translate-x-1'"
                />
            </button>
            <span class="text-sm font-medium" :class="perUser ? 'text-nashi-900 font-bold' : 'text-nashi-900/60'">Prix / Utilisateur</span>
          </div>
        </div>

        <!-- Pricing Intelligence -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          {intelligenceOffers.map(offer => (
            <div class={`relative rounded-2xl p-8 flex flex-col ${offer.highlight ? 'bg-nashi-900 text-white shadow-xl scale-105 z-10' : 'bg-white border border-nashi-200 text-nashi-900'}`}>
              {offer.highlight && (
                <div class="absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2">
                  <span class="bg-nashi-500 text-nashi-900 text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wide">Recommandé</span>
                </div>
              )}
              <h3 class="text-2xl font-bold mb-2">{offer.name}</h3>
              <p class={`text-sm mb-6 ${offer.highlight ? 'text-nashi-300' : 'text-nashi-500'}`}>{offer.target}</p>
              
              <div class="mb-6 h-20 relative overflow-hidden">
                <!-- Prix Total -->
                <div 
                    class="absolute inset-0 flex flex-col justify-center transition-all duration-500 ease-out"
                    :class="!perUser ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-8 pointer-events-none'"
                >
                    <div class="flex items-baseline gap-1">
                        <span class="text-4xl font-extrabold">{offer.price}€</span>
                        <span class={`text-sm ${offer.highlight ? 'text-nashi-300' : 'text-nashi-500'}`}> HT / mois</span>
                    </div>
                    <span class={`text-xs ${offer.highlight ? 'text-nashi-400' : 'text-nashi-400'}`}>Pour {offer.users}</span>
                </div>

                <!-- Prix par Utilisateur -->
                <div 
                    class="absolute inset-0 flex flex-col justify-center transition-all duration-500 ease-out"
                    :class="perUser ? 'opacity-100 translate-y-0' : 'opacity-0 -translate-y-8 pointer-events-none'"
                >
                    <div class="flex items-baseline gap-1">
                        <span class="text-4xl font-extrabold">{(parseInt(offer.price) / offer.maxUsers).toFixed(0)}€</span>
                        <span class={`text-sm ${offer.highlight ? 'text-nashi-300' : 'text-nashi-500'}`}> HT / mois</span>
                    </div>
                    <span class={`text-xs ${offer.highlight ? 'text-nashi-400' : 'text-nashi-400'}`}>par utilisateur (base {offer.maxUsers})</span>
                </div>
              </div>

              <ul class="space-y-4 mb-8 flex-grow">
                {offer.features.map(feature => (
                  <li class="flex items-start">
                    <svg class={`w-5 h-5 mr-3 flex-shrink-0 ${offer.highlight ? 'text-nashi-400' : 'text-nashi-600'}`} fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                    <span class="text-sm">{feature}</span>
                  </li>
                ))}
              </ul>

              <button 
                @click="$dispatch('open-contact-modal', { offer: 'Intelligence ' + offer.name })"
                class={`w-full py-3 rounded-xl font-bold transition-all ${offer.highlight ? 'bg-white text-nashi-900 hover:bg-nashi-100' : 'bg-nashi-100 text-nashi-900 hover:bg-nashi-200'}`}
              >
                Choisir {offer.name}
              </button>
            </div>
          ))}
        </div>

        <!-- Frais de mise en service -->
        <div class="mt-12 max-w-3xl mx-auto">
            <div class="p-6 bg-nashi-50 rounded-xl border border-nashi-200 text-left flex flex-col md:flex-row gap-6 items-center">
                <div class="flex-shrink-0 p-3 bg-white rounded-full shadow-sm">
                    <svg class="w-8 h-8 text-nashi-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" /></svg>
                </div>
                <div class="flex-grow">
                    <p class="text-lg text-nashi-900 font-bold mb-1">
                        Mise en service (One-shot) : 420€ HT
                    </p>
                    <p class="text-sm text-nashi-600">
                        Installation de votre instance IA privée, sécurisation du VPS, configuration du RAG (ingestion initiale de vos documents) et formation des administrateurs.
                    </p>
                </div>
            </div>
        </div>

        <!-- Modèles Disponibles (Annexe) -->
        <div class="mt-16 text-center border-t border-nashi-200 pt-12">
            <h3 class="text-lg font-bold text-nashi-900 uppercase tracking-wider mb-10">Modèles IA Supportés (Liste non exhaustive)</h3>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-6 max-w-4xl mx-auto">
                <!-- Mistral -->
                <div class="flex flex-col items-center p-6 rounded-2xl bg-nashi-50 border border-nashi-100 hover:border-nashi-300 transition-colors">
                    <span class="font-extrabold text-xl text-nashi-900 mb-2">Mistral AI</span>
                    <span class="text-sm text-nashi-600 font-medium">France / Open Source</span>
                </div>
                <!-- Meta -->
                <div class="flex flex-col items-center p-6 rounded-2xl bg-nashi-50 border border-nashi-100 hover:border-blue-200 transition-colors">
                    <span class="font-extrabold text-xl text-nashi-900 mb-2">Llama 3</span>
                    <span class="text-sm text-nashi-600 font-medium">Meta / Performance</span>
                </div>
                <!-- Google -->
                <div class="flex flex-col items-center p-6 rounded-2xl bg-nashi-50 border border-nashi-100 hover:border-red-200 transition-colors">
                    <span class="font-extrabold text-xl text-nashi-900 mb-2">Gemma</span>
                    <span class="text-sm text-nashi-600 font-medium">Google / Lightweight</span>
                </div>
                <!-- Qwen -->
                <div class="flex flex-col items-center p-6 rounded-2xl bg-nashi-50 border border-nashi-100 hover:border-purple-200 transition-colors">
                    <span class="font-extrabold text-xl text-nashi-900 mb-2">Qwen</span>
                    <span class="text-sm text-nashi-600 font-medium">Alibaba / Code</span>
                </div>
            </div>
            <p class="mt-10 text-base text-nashi-700 max-w-2xl mx-auto font-medium">
                Nous sélectionnons avec vous le modèle le plus adapté à votre cas d'usage (Performance vs Coût vs Confidentialité).
                <br/><span class="text-nashi-500 text-sm font-normal mt-2 block">D'autres modèles (Claude, GPT-4o) sont disponibles via API sur demande.</span>
            </p>
        </div>

      </div>
    </section>

    <!-- SECTION 2: NASHI AUTOMATE -->
    <section id="automate" class="py-24 bg-nashi-50">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-12">
          <h2 class="text-3xl md:text-4xl font-bold text-nashi-900 mb-4">Nashi Automate</h2>
          <p class="text-lg text-nashi-600 max-w-2xl mx-auto mb-8">
            Le moteur de votre productivité. Choisissez votre mode de fonctionnement.
          </p>
          
          <!-- TABS -->
          <div class="inline-flex bg-white p-1 rounded-xl border border-nashi-200 shadow-sm">
            <button 
                @click="automationTab = 'n8n'"
                :class="automationTab === 'n8n' ? 'bg-orange-100 text-orange-800 shadow-sm' : 'text-nashi-600 hover:bg-nashi-50'"
                class="px-6 py-2.5 rounded-lg font-bold text-sm transition-all flex items-center gap-2"
            >
                <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" /></svg>
                Mode Autonomie (n8n)
            </button>
            <button 
                @click="automationTab = 'python'"
                :class="automationTab === 'python' ? 'bg-blue-100 text-blue-800 shadow-sm' : 'text-nashi-600 hover:bg-nashi-50'"
                class="px-6 py-2.5 rounded-lg font-bold text-sm transition-all flex items-center gap-2"
            >
                <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" /></svg>
                Mode Sur-Mesure (Python)
            </button>
          </div>
        </div>

        <!-- CONTENT: n8n -->
        <div x-show="automationTab === 'n8n'" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0 transform scale-95" x-transition:enter-end="opacity-100 transform scale-100">
            <div class="bg-orange-50 border border-orange-100 rounded-2xl p-6 mb-8 text-center max-w-3xl mx-auto">
                <h3 class="font-bold text-orange-900 mb-2">Pour les équipes techniques</h3>
                <p class="text-orange-800/80 text-sm">
                    Nous déployons et maintenons votre instance n8n sur nos serveurs. Vous créez vos workflows en toute liberté.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
              {n8nOffers.map(offer => (
                <div class={`bg-white p-8 rounded-2xl border transition-all flex flex-col ${offer.highlight ? 'border-orange-400 shadow-lg scale-105 z-10' : 'border-nashi-200 hover:border-orange-300'}`}>
                  {offer.highlight && <div class="text-center mb-4"><span class="bg-orange-100 text-orange-800 text-xs font-bold px-3 py-1 rounded-full uppercase">Populaire</span></div>}
                  <h4 class="font-bold text-2xl text-nashi-900 mb-1">{offer.name}</h4>
                  <p class="text-sm text-nashi-500 mb-6">{offer.target}</p>
                  
                  <div class="mb-6">
                      <span class="text-4xl font-extrabold text-nashi-900">{offer.price}€</span>
                      <span class="text-sm text-nashi-500"> HT / mois</span>
                  </div>

                  <ul class="space-y-3 mb-8 flex-grow">
                    {offer.features.map(feature => (
                      <li class="flex items-center text-sm text-nashi-700">
                        <svg class="w-5 h-5 mr-3 text-orange-500 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>
                        {feature}
                      </li>
                    ))}
                  </ul>
                  <button 
                    @click="$dispatch('open-contact-modal', { offer: 'n8n ' + offer.name })"
                    class={`w-full py-3 rounded-xl font-bold transition-colors ${offer.highlight ? 'bg-orange-500 text-white hover:bg-orange-600' : 'bg-orange-50 text-orange-900 hover:bg-orange-100'}`}
                  >
                    Choisir {offer.name}
                  </button>
                </div>
              ))}
            </div>
        </div>

        <!-- CONTENT: Python -->
        <div x-show="automationTab === 'python'" style="display: none;" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0 transform scale-95" x-transition:enter-end="opacity-100 transform scale-100">
            <div class="bg-blue-50 border border-blue-100 rounded-2xl p-6 mb-8 text-center max-w-3xl mx-auto">
                <h3 class="font-bold text-blue-900 mb-2">Solution "Clé en main"</h3>
                <p class="text-blue-800/80 text-sm">
                    Dites-nous ce que vous voulez automatiser. Nos développeurs codent des scripts Python robustes et maintenables pour vous.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
              {pythonOffers.map(offer => (
                <div class={`bg-white p-8 rounded-2xl border transition-all flex flex-col ${offer.highlight ? 'border-blue-400 shadow-lg scale-105 z-10' : 'border-nashi-200 hover:border-blue-300'}`}>
                  {offer.highlight && <div class="text-center mb-4"><span class="bg-blue-100 text-blue-800 text-xs font-bold px-3 py-1 rounded-full uppercase">Recommandé</span></div>}
                  <h4 class="font-bold text-2xl text-nashi-900 mb-1">{offer.name}</h4>
                  <p class="text-sm text-nashi-500 mb-2 italic">{offer.desc}</p>
                  <p class="text-xs text-nashi-400 mb-6">{offer.target}</p>
                  
                  <div class="mb-6">
                      <span class="text-3xl font-extrabold text-nashi-900">{offer.price}</span>
                      {offer.price !== "Sur Devis" && <span class="text-xl font-bold text-nashi-900">€</span>}
                      {offer.price !== "Sur Devis" && <span class="text-sm text-nashi-500"> / mois</span>}
                  </div>

                  <ul class="space-y-3 mb-8 flex-grow">
                    {offer.features.map(feature => (
                      <li class="flex items-center text-sm text-nashi-700">
                        <svg class="w-5 h-5 mr-3 text-blue-500 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>
                        {feature}
                      </li>
                    ))}
                  </ul>
                  
                  <div class="mt-auto">
                    <p class="text-xs text-center text-nashi-400 mb-3">+ Frais de setup (One-shot)</p>
                    <button 
                      @click="$dispatch('open-contact-modal', { offer: 'Python ' + offer.name })"
                      class={`w-full py-3 rounded-xl font-bold transition-colors ${offer.highlight ? 'bg-blue-600 text-white hover:bg-blue-700' : 'bg-blue-50 text-blue-900 hover:bg-blue-100'}`}
                    >
                      Demander un devis
                    </button>
                  </div>
                </div>
              ))}
            </div>
        </div>

      </div>
    </section>

    <!-- FAQ / Reassurance -->
    <section class="py-20 bg-white border-t border-nashi-100">
      <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <h2 class="text-2xl font-bold text-nashi-900 mb-8">Inclus dans toutes nos offres</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          <div>
            <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4 text-green-600">
              <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" /></svg>
            </div>
            <h3 class="font-bold text-nashi-900">Sécurité Maximale</h3>
            <p class="text-sm text-nashi-600 mt-2">VPS OVH dédié ou isolé. Firewall strict, Fail2Ban, Backups chiffrés S3.</p>
          </div>
          <div>
            <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4 text-purple-600">
              <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z" /></svg>
            </div>
            <h3 class="font-bold text-nashi-900">Privacy Shield</h3>
            <p class="text-sm text-nashi-600 mt-2">Vos données ne transitent jamais par les US. API Management géré par nos soins.</p>
          </div>
          <div>
            <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4 text-blue-600">
              <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
            </div>
            <h3 class="font-bold text-nashi-900">Onboarding Humain</h3>
            <p class="text-sm text-nashi-600 mt-2">30 min de visio incluse pour la prise en main et la configuration initiale.</p>
          </div>
        </div>
      </div>
    </section>

  </main>
  <Footer />
</Layout>